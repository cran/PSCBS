###########################################################
# This tests:
# - segmentByCBS(...)
# - segmentByCBS(..., knownSegments)
# - tileChromosomes()
# - plotTracks()
###########################################################
library("PSCBS")

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Load SNP microarray data
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
data <- PSCBS::exampleData("paired.chr01")

## Setup basic data
CT <- data$CT/data$CN
muN <- callNaiveGenotypes(data$betaN, censorAt=c(0,1))
isSnp <- (!is.na(data$betaT) & !is.na(data$muN))
isHet <- isSnp & (data$muN == 1/2)
rho <- rep(NA_real_, length=nrow(data))
rho[isHet] <- 2*abs(data$betaTN[isHet]-1/2)

data <- cbind(data[,c("chromosome", "x")], CT=CT, rho=rho)
segs <- data.frame(chromosome=sort(unique(data$chromosome)))
fit <- structure(list(data=data, output=segs), class=c("PairedPSCBS", "PSCBS", "AbstractCBS", class(data)))

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Paired PSCBS segmentation
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Drop single-locus outliers
dataS <- dropSegmentationOutliers(data)
